{% extends 'geco/base.html' %}
{% block styles %}
{% load static %}
    <link rel="stylesheet" type="text/css" 
        href="{% static "geco/GeCoVizjs/static/css/colors.css" %}"/>
    <link rel="stylesheet" type="text/css" 
        href="{% static "geco/GeCoVizjs/static/css/scrollbar.css" %}"/>
    <link rel="stylesheet" type="text/css" 
        href="{% static "geco/GeCoVizjs/static/css/selectBox.css" %}"/>
    <link rel="stylesheet" type="text/css" 
        href="{% static "geco/GeCoVizjs/static/css/customBar.css" %}"/>
    <link rel="stylesheet" type="text/css" 
        href="{% static "geco/GeCoVizjs/static/css/popper.css" %}"/>
    <link rel="stylesheet" type="text/css" 
        href="{% static "geco/GeCoVizjs/static/css/gecoviz.css" %}"/>
{% endblock %}
{% block content %}

{% include 'geco/filter_cards.html'%}

<div v-if="show_items != {}" >
<div v-for="(tdata, tid, index) in show_items">               
    {% include 'geco/card.html' %}
</div>
</div>

{% endblock %}
{% block scripts %}
    <script src = "https://unpkg.com/@popperjs/core@2"></script>
    <script src="{% static "geco/assets/tabler/libs/nouislider/distribute/nouislider.min.js" %}"></script>
    <script src="{% static "geco/GeCoVizjs/src/html2canvas.min.js" %}"></script>
    <script src="{% static "geco/GeCoVizjs/src/FileSaver.min.js" %}"></script>
    <script src="{% static "geco/GeCoVizjs/src/colors269.js" %}"></script>
    <script src="{% static "geco/GeCoVizjs/src/palette.js" %}"></script>
    <script src="{% static "geco/GeCoVizjs/src/helpers.js" %}"></script>
    <script src="{% static "geco/GeCoVizjs/src/selectBox.js" %}"></script>
    <script src="{% static "geco/GeCoVizjs/src/slider.js" %}"></script>
    <script src="{% static "geco/GeCoVizjs/src/customBar.js" %}"></script>
    <script src="{% static "geco/GeCoVizjs/src/domains.js" %}"></script>
    <script src="{% static "geco/GeCoVizjs/src/popper.js" %}"></script>
    <script src="{% static "geco/GeCoVizjs/src/newick.js" %}"></script>
    <script src="{% static "geco/GeCoVizjs/src/tree.js" %}"></script>
    <script src="{% static "geco/GeCoVizjs/src/gecoviz.js" %}"></script>
    <script src="{% static "geco/js/gmgc.js" %}"></script>
    <script charset="utf-8">
      $(document).ready(function () {
          $(".form-help").popover();
          let searchType = document.getElementById('search-type');
          let choices = new Choices(searchType, {
            classNames: {
                containerInner: searchType.className,
                input: 'form-control',
                inputCloned: 'form-control-sm',
                listDropdown: 'dropdown-menu',
                itemChoice: 'dropdown-item',
                activeState: 'show',
                selectedState: 'active',
                placeholder: 'choices__placeholder',
            },
            shouldSort: false,
            searchEnabled: false,
            choices : [
                { value: 'fam', label: 'Family name', selected: true },
                { value: 'taxa', id: 'taxa', label: 'Taxon name' },
                { value: 'function', label: 'Functional context' },
            ]
          });
          d3.select('#taxa')
            .attr('data-toggle', 'collapse')
            .attr('href', '#filter-cards')
            .attr('aria-expanded', 'false')
            .attr('aria-controls', 'filter-cards')
          ["specificity", "coverage"].forEach(id => {
                let slider = document.getElementById(id);
                noUiSlider.create(slider,
                    {
                        start: .9,
                        connect: [true, false],
                        step: .01,
                        range: {
                            min: 0,
                            max: 1
                            }
                    });
                let sliderLabel = d3.select(`.${id} label`);
                slider = slider.noUiSlider;
                slider.on('update', () => {
                    let name =  id.trim().replace(/^\w/, c => c.toUpperCase());
                    sliderLabel.html(name+': '+slider.get());
                })
          })
      });
    </script>
{% endblock %}
